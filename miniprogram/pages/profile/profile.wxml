<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-info-card">
    <view class="user-avatar" bindtap="chooseAvatar">
      <image wx:if="{{avatarUrl}}" class="avatar-image" src="{{avatarUrl}}" mode="aspectFill"></image>
      <text wx:else class="avatar-text">{{nickname[0]}}</text>
      <view class="avatar-edit-icon">
        <text class="edit-icon">ğŸ“·</text>
      </view>
    </view>
    <view class="user-details">
      <text class="user-nickname">{{nickname}}</text>
      <text class="user-id">ID: {{userId}}</text>
    </view>
  </view>
  
  <!-- æŠ•ç¥¨ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="stats-header">
      <text class="stats-title">æŠ•ç¥¨ç»Ÿè®¡</text>
    </view>
    <view class="stats-content">
      <view class="stat-item">
        <text class="stat-value">{{votingStats.totalVotes}}</text>
        <text class="stat-label">æ€»æŠ•ç¥¨æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{votingStats.correctPredictions}}</text>
        <text class="stat-label">æ­£ç¡®é¢„æµ‹</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{votingStats.accuracy}}%</text>
        <text class="stat-label">å‡†ç¡®ç‡</text>
      </view>
    </view>
  </view>
  
  <!-- æ ‡ç­¾æ  -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">
      æŠ•ç¥¨å†å²
    </view>
    <view class="tab-item {{activeTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">
      ä¸ªäººè®¾ç½®
    </view>
  </view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">åŠ è½½ä¸­...</view>
  </view>
  
  <!-- é”™è¯¯æç¤º -->
  <view class="error-container" wx:elif="{{error}}">
    <view class="error-message">{{error}}</view>
    <button class="retry-btn" bindtap="loadUserData">é‡è¯•</button>
  </view>
  
  <!-- æŠ•ç¥¨å†å²å†…å®¹ -->
  <view class="tab-content" wx:elif="{{activeTab === 0}}">
    <view class="empty-message" wx:if="{{voteHistory.length === 0}}">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— æŠ•ç¥¨è®°å½•</text>
      <text class="empty-desc">å‚ä¸æ¯”èµ›æŠ•ç¥¨åï¼Œè¿™é‡Œå°†æ˜¾ç¤ºæ‚¨çš„æŠ•ç¥¨å†å²</text>
    </view>
    
    <scroll-view scroll-y="true" class="vote-history-list" wx:else>
      <view class="vote-item" wx:for="{{voteHistory}}" wx:key="_id">
        <view class="vote-match-info">
          <text class="vote-match-title">{{item.matchTitle}}</text>
          <text class="vote-match-teams">{{item.team1}} VS {{item.team2}}</text>
        </view>
        
        <view class="vote-details">
          <view class="vote-team">
            æŠ•ç¥¨: <text class="team-name {{item.teamId === item.result.winner ? 'team1' : 'team2'}}">{{item.teamName}}</text>
          </view>
          
          <view class="vote-result" wx:if="{{item.matchStatus === 'å·²ç»“æŸ' || item.matchStatus === 'FINISHED'}}">
            <text class="result-text {{item.isCorrect ? 'correct' : 'wrong'}}">
              {{item.isCorrect ? 'âœ“ é¢„æµ‹æ­£ç¡®' : 'âœ— é¢„æµ‹é”™è¯¯'}}
            </text>
          </view>
          <view class="vote-status" wx:else>
            <text class="status-text">{{item.matchStatus}}</text>
          </view>
        </view>
        
        <text class="vote-time">{{item.voteTime}}</text>
      </view>
    </scroll-view>
  </view>
  
  <!-- ä¸ªäººè®¾ç½®å†…å®¹ -->
  <view class="tab-content" wx:elif="{{activeTab === 1}}">
    <view class="settings-form">
      <view class="form-item">
        <text class="form-label">æ˜µç§°</text>
        <input class="form-input" value="{{nickname}}" placeholder="è¯·è¾“å…¥æ˜µç§°" bindblur="updateNickname"/>
      </view>
      
      <view class="form-item">
        <text class="form-label">ç”¨æˆ·ID</text>
        <text class="form-value">{{userId}}</text>
      </view>
    </view>
  </view>
</view>
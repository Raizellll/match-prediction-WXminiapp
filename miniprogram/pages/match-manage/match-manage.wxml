<!--pages/match-manage/match-manage.wxml-->
<view class="match-manage-container">
  <!-- å¤´éƒ¨æ ‡é¢˜ -->
  <view class="header">
    <view class="title">æ¯”èµ›ç®¡ç†</view>
    <view class="add-btn" bindtap="addMatch">
      <text class="add-icon">+</text>
      <text class="add-text">æ·»åŠ æ¯”èµ›</text>
    </view>
  </view>

  <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
  <scroll-view class="date-selector" scroll-x="true" scroll-into-view="{{currentDateId}}">
    <view class="date-item {{selectedDate === 'all' ? 'selected' : ''}}" bindtap="selectDate" data-date="all" id="date-all">
      <text>All</text>
    </view>
    <block wx:for="{{dateList}}" wx:key="date">
      <view class="date-item {{selectedDate === item.date ? 'selected' : ''}}" bindtap="selectDate" data-date="{{item.date}}" id="date-{{item.date}}">
        <text class="weekday">{{item.weekday}}</text>
        <text class="date">{{item.displayDate}}</text>
      </view>
    </block>
  </scroll-view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">åŠ è½½ä¸­...</view>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view class="error-container" wx:elif="{{error}}">
    <view class="error-message">{{error}}</view>
    <button class="retry-btn" bindtap="loadMatches">é‡è¯•</button>
  </view>

  <!-- æ¯”èµ›åˆ—è¡¨ -->
  <scroll-view wx:elif="{{filteredMatches.length > 0}}" scroll-y="true" class="match-list">
    <view class="match-item" wx:for="{{filteredMatches}}" wx:key="_id">
      <view class="match-content">
        <!-- æ¯”èµ›çŠ¶æ€æ ‡è®° -->
        <view class="match-status {{item.status === 'æœªå¼€å§‹' ? 'status-upcoming' : item.status === 'è¿›è¡Œä¸­' ? 'status-ongoing' : 'status-finished'}}">
          {{item.status}}
        </view>
        
        <!-- æ¯”èµ›ä¿¡æ¯ -->
        <view class="match-info">
          <view class="match-title">{{item.title}}</view>
          <view class="match-teams">
            <view class="team {{item.status === 'å·²ç»“æŸ' && item.result.winner === item.team1._id ? 'winner-team' : ''}}">{{item.team1.name}}</view>
            <view class="vs">VS</view>
            <view class="team {{item.status === 'å·²ç»“æŸ' && item.result.winner === item.team2._id ? 'winner-team' : ''}}">{{item.team2.name}}</view>
          </view>
          
          <!-- æ¯”èµ›æ—¥æœŸæ—¶é—´ -->
          <view class="match-time">{{item.date}}</view>
          
          <!-- æ¯”èµ›ç»“æœï¼ˆå¦‚æœå·²ç»“æŸï¼‰ -->
          <view class="match-result" wx:if="{{item.status === 'å·²ç»“æŸ' || item.status === 'FINISHED'}}">
            <view class="result-label">è·èƒœæ–¹:</view>
            <view class="winner">{{item.result.winner === item.team1._id ? item.team1.name : item.team2.name}} ğŸ†</view>
          </view>
        </view>
      </view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="match-actions">
        <view class="action-btn edit-btn" bindtap="editMatch" data-id="{{item._id}}">
          <text class="action-text">ç¼–è¾‘</text>
        </view>
        <view class="action-btn delete-btn" bindtap="deleteMatch" data-id="{{item._id}}">
          <text class="action-text">åˆ é™¤</text>
        </view>
        <view class="action-btn vote-btn" bindtap="goToVote" data-id="{{item._id}}">
          <text class="action-text">æŸ¥çœ‹</text>
        </view>
      </view>
    </view>
  </scroll-view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:else>
    <view class="empty-icon">ğŸ†</view>
    <view class="empty-message">æš‚æ— æ¯”èµ›</view>
    <view class="empty-desc">ç‚¹å‡»ä¸Šæ–¹"æ·»åŠ æ¯”èµ›"æŒ‰é’®åˆ›å»ºä¸€åœºæ–°æ¯”èµ›</view>
  </view>
</view>